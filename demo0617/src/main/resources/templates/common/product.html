<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<div th:insert="/common/nav"></div>

<div th:each="product : ${product}">
    <div>
        <div th:text="${product.productName}"></div>

        <div th:switch="${product.imgType}">
            <div th:case="'url'"><img style="width:50px; height:50px;" th:src=" @{ ${product.productUrlImg} }"></div>
            <div th:case="'file'"><img style="width:50px; height:50px;"
                                       th:src=" @{/upload-dir/} + ${product.productFileImg}"></div>
        </div>

        <div th:text="${product.productPrice}"></div>
        <div th:text="${product.quantity}"></div>
    </div>
</div>

<div th:each="product : ${product}">


    QTY : <input type="text" id="quantity" value="1" >
    <input type="text" id="id" name="id" th:value="${product.id}" hidden >

    <button type="submit" id="btn-cart">카트</button>
    <button type="submit" id="btn-order">구매</button>

</div>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

<script>

    $('#btn-order').click(function () {

        var productId = document.getElementById("id").value;

        var data = {
            id: $('#id').val(),
            quantity: $('#quantity').val()
        };

        $.ajax({
            type: 'post',
            url: '/order/' + productId,
            data: data,
            dataType: 'text'
        }).done(function (data) {
            window.location.href = "/customer/order";
        }).fail(function (error) {
            console.log(error);
            alert(error.valueOf());
        })

    });


    $('#btn-cart').click(function () {
        var data = {
            id: $('#id').val(),
            quantity: $('#quantity').val()
        };

        $.ajax({
            type: 'post',
            url: '/cart',
            data: data,
            dataType: 'text'
        }).done(function (data) {
            window.location.href = "/cart";
        }).fail(function (error) {
            alert(error)
        })

    });


</script>


</body>
</html>